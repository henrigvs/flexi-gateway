server:
  port: ${GATEWAY_PORT:8443}

spring:
  application:
    name: flexi-gate
  cloud:
    gateway:
      server:
        webflux:
          routes:
            # üåê WebSocket
            - id: usma-websocket
              uri: lb:ws://usma
              predicates:
                - Path=/ws/**
                - Header=Upgrade, websocket

            # üîÅ REST (load balanced)
            - id: usma-rest
              uri: lb://usma
              predicates:
                - Path=/usma/api/**
              filters:
                - StripPrefix=2

    discovery:
      enabled: false
      client:
        simple:
          instances:
            usma:
              - uri: http://usma:8090
              - uri: http://usma:8091

eureka:
  client:
    service-url:
      defaultZone: http://eureka:8761/eureka/

management:
  endpoints:
    web:
      exposure:
        include: health

logging:
  level:
    org.springframework.cloud.gateway: DEBUG
    org.springframework.web: DEBUG
    org.springframework.cloud.client.discovery.simple: DEBUG
    reactor.netty.http.client: DEBUG